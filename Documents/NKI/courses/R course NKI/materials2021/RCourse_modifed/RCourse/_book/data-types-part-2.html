<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data types, part 2 | Using R for data analysis</title>
  <meta name="description" content="This course teaches the basics of R, an open-source and free environment for statistical analyses. In this course we also teach the basics transparent and reproducible research. For this, we teach RMarkdown, a tool to make dynamic reports in R." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data types, part 2 | Using R for data analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This course teaches the basics of R, an open-source and free environment for statistical analyses. In this course we also teach the basics transparent and reproducible research. For this, we teach RMarkdown, a tool to make dynamic reports in R." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data types, part 2 | Using R for data analysis" />
  
  <meta name="twitter:description" content="This course teaches the basics of R, an open-source and free environment for statistical analyses. In this course we also teach the basics transparent and reproducible research. For this, we teach RMarkdown, a tool to make dynamic reports in R." />
  



<meta name="date" content="2021-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-types-part-1.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this course</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#teachers"><i class="fa fa-check"></i>Teachers</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#goals-topics"><i class="fa fa-check"></i>Goals &amp; Topics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#materials"><i class="fa fa-check"></i>Materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#programme"><i class="fa fa-check"></i>Programme</a>
<ul>
<li class="chapter" data-level="0.0.1" data-path="index.html"><a href="index.html#second-nki-edition-june-7th-8th-10th-and-11th-2021"><i class="fa fa-check"></i><b>0.0.1</b> Second NKI edition, June 7th, 8th, 10th, and 11th 2021</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="basics-of-r.html"><a href="basics-of-r.html"><i class="fa fa-check"></i><b>1</b> Basics of R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics-of-r.html"><a href="basics-of-r.html#data-sets"><i class="fa fa-check"></i><b>1.1</b> Data sets</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="basics-of-r.html"><a href="basics-of-r.html#pulse"><i class="fa fa-check"></i><b>1.1.1</b> Pulse</a></li>
<li class="chapter" data-level="1.1.2" data-path="basics-of-r.html"><a href="basics-of-r.html#survey"><i class="fa fa-check"></i><b>1.1.2</b> Survey</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="basics-of-r.html"><a href="basics-of-r.html#introduction"><i class="fa fa-check"></i><b>1.2</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="basics-of-r.html"><a href="basics-of-r.html#why-this-course"><i class="fa fa-check"></i><b>1.2.1</b> Why this course?</a></li>
<li class="chapter" data-level="1.2.2" data-path="basics-of-r.html"><a href="basics-of-r.html#what-is-r"><i class="fa fa-check"></i><b>1.2.2</b> What is R?</a></li>
<li class="chapter" data-level="1.2.3" data-path="basics-of-r.html"><a href="basics-of-r.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> R and RStudio</a></li>
<li class="chapter" data-level="1.2.4" data-path="basics-of-r.html"><a href="basics-of-r.html#course-overview"><i class="fa fa-check"></i><b>1.2.4</b> Course overview</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="basics-of-r.html"><a href="basics-of-r.html#basics"><i class="fa fa-check"></i><b>1.3</b> Basics</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="basics-of-r.html"><a href="basics-of-r.html#r-as-a-calculator"><i class="fa fa-check"></i><b>1.3.1</b> R as a calculator</a></li>
<li class="chapter" data-level="1.3.2" data-path="basics-of-r.html"><a href="basics-of-r.html#variables"><i class="fa fa-check"></i><b>1.3.2</b> Variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="basics-of-r.html"><a href="basics-of-r.html#vectors"><i class="fa fa-check"></i><b>1.3.3</b> Vectors</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="basics-of-r.html"><a href="basics-of-r.html#projects-and-scripts"><i class="fa fa-check"></i><b>1.4</b> Projects and scripts</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="basics-of-r.html"><a href="basics-of-r.html#projects"><i class="fa fa-check"></i><b>1.4.1</b> Projects</a></li>
<li class="chapter" data-level="1.4.2" data-path="basics-of-r.html"><a href="basics-of-r.html#reading-data"><i class="fa fa-check"></i><b>1.4.2</b> Reading data</a></li>
<li class="chapter" data-level="1.4.3" data-path="basics-of-r.html"><a href="basics-of-r.html#scripts"><i class="fa fa-check"></i><b>1.4.3</b> Scripts</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="basics-of-r.html"><a href="basics-of-r.html#data-frames-basics"><i class="fa fa-check"></i><b>1.5</b> Data frames (basics)</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="basics-of-r.html"><a href="basics-of-r.html#exploring"><i class="fa fa-check"></i><b>1.5.1</b> Exploring</a></li>
<li class="chapter" data-level="1.5.2" data-path="basics-of-r.html"><a href="basics-of-r.html#extracting"><i class="fa fa-check"></i><b>1.5.2</b> Extracting</a></li>
<li class="chapter" data-level="1.5.3" data-path="basics-of-r.html"><a href="basics-of-r.html#example-data"><i class="fa fa-check"></i><b>1.5.3</b> Example data</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="basics-of-r.html"><a href="basics-of-r.html#basic-data-types"><i class="fa fa-check"></i><b>1.6</b> Basic data types</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="basics-of-r.html"><a href="basics-of-r.html#types"><i class="fa fa-check"></i><b>1.6.1</b> Types</a></li>
<li class="chapter" data-level="1.6.2" data-path="basics-of-r.html"><a href="basics-of-r.html#vector-classes"><i class="fa fa-check"></i><b>1.6.2</b> Vector classes</a></li>
<li class="chapter" data-level="1.6.3" data-path="basics-of-r.html"><a href="basics-of-r.html#character-data"><i class="fa fa-check"></i><b>1.6.3</b> Character data</a></li>
<li class="chapter" data-level="1.6.4" data-path="basics-of-r.html"><a href="basics-of-r.html#factor---categorical-data"><i class="fa fa-check"></i><b>1.6.4</b> Factor - categorical data</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="basics-of-r.html"><a href="basics-of-r.html#functions-and-help-files"><i class="fa fa-check"></i><b>1.7</b> Functions and help files</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="basics-of-r.html"><a href="basics-of-r.html#function-arguments"><i class="fa fa-check"></i><b>1.7.1</b> Function arguments</a></li>
<li class="chapter" data-level="1.7.2" data-path="basics-of-r.html"><a href="basics-of-r.html#other-help-file-aspects"><i class="fa fa-check"></i><b>1.7.2</b> Other help file aspects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-types-part-1.html"><a href="data-types-part-1.html"><i class="fa fa-check"></i><b>2</b> Data types, part 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-types-part-1.html"><a href="data-types-part-1.html#basic-data-types-cont."><i class="fa fa-check"></i><b>2.1</b> Basic data types (cont.)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-types-part-1.html"><a href="data-types-part-1.html#missing-values"><i class="fa fa-check"></i><b>2.1.1</b> Missing values</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-types-part-1.html"><a href="data-types-part-1.html#numeric-vectors"><i class="fa fa-check"></i><b>2.1.2</b> Numeric vectors</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-types-part-1.html"><a href="data-types-part-1.html#character-vectors"><i class="fa fa-check"></i><b>2.1.3</b> Character vectors</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-types-part-1.html"><a href="data-types-part-1.html#logical-vectors"><i class="fa fa-check"></i><b>2.1.4</b> Logical vectors</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-types-part-1.html"><a href="data-types-part-1.html#type-conversions"><i class="fa fa-check"></i><b>2.1.5</b> Type conversions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-types-part-1.html"><a href="data-types-part-1.html#vectors-1"><i class="fa fa-check"></i><b>2.2</b> Vectors</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-types-part-1.html"><a href="data-types-part-1.html#square-brackets-operator"><i class="fa fa-check"></i><b>2.2.1</b> Square brackets operator</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-types-part-1.html"><a href="data-types-part-1.html#other-useful-functions"><i class="fa fa-check"></i><b>2.2.2</b> Other useful functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-types-part-1.html"><a href="data-types-part-1.html#data-frames"><i class="fa fa-check"></i><b>2.3</b> Data frames</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-types-part-1.html"><a href="data-types-part-1.html#what-is-a-data-frame"><i class="fa fa-check"></i><b>2.3.1</b> What is a data frame</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-types-part-1.html"><a href="data-types-part-1.html#creating"><i class="fa fa-check"></i><b>2.3.2</b> Creating</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-types-part-1.html"><a href="data-types-part-1.html#properties"><i class="fa fa-check"></i><b>2.3.3</b> Properties</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-types-part-1.html"><a href="data-types-part-1.html#content"><i class="fa fa-check"></i><b>2.3.4</b> Content</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-types-part-1.html"><a href="data-types-part-1.html#matrices"><i class="fa fa-check"></i><b>2.4</b> Matrices</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-types-part-1.html"><a href="data-types-part-1.html#what-is-a-matrix"><i class="fa fa-check"></i><b>2.4.1</b> What is a matrix</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-types-part-1.html"><a href="data-types-part-1.html#creation"><i class="fa fa-check"></i><b>2.4.2</b> Creation</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-types-part-1.html"><a href="data-types-part-1.html#dimensions-2"><i class="fa fa-check"></i><b>2.4.3</b> Dimensions</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-types-part-1.html"><a href="data-types-part-1.html#settinggetting-names-of-the-columns-and-rows"><i class="fa fa-check"></i><b>2.4.4</b> Setting/getting names of the columns and rows</a></li>
<li class="chapter" data-level="2.4.5" data-path="data-types-part-1.html"><a href="data-types-part-1.html#getting-matrix-elements"><i class="fa fa-check"></i><b>2.4.5</b> Getting matrix elements</a></li>
<li class="chapter" data-level="2.4.6" data-path="data-types-part-1.html"><a href="data-types-part-1.html#useful-matrix-functions"><i class="fa fa-check"></i><b>2.4.6</b> Useful matrix functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-types-part-2.html"><a href="data-types-part-2.html"><i class="fa fa-check"></i><b>3</b> Data types, part 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types-part-2.html"><a href="data-types-part-2.html#r-scripts-and-reports-rmarkdown"><i class="fa fa-check"></i><b>3.1</b> R scripts and reports (Rmarkdown)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-types-part-2.html"><a href="data-types-part-2.html#markdown-r-code-markdown-text-formating-language"><i class="fa fa-check"></i><b>3.1.1</b> Markdown : R code + Markdown text formating language</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-types-part-2.html"><a href="data-types-part-2.html#features-of-r-markdown"><i class="fa fa-check"></i><b>3.1.2</b> Features of R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-types-part-2.html"><a href="data-types-part-2.html#lists"><i class="fa fa-check"></i><b>3.2</b> Lists</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-types-part-2.html"><a href="data-types-part-2.html#what-is-a-list"><i class="fa fa-check"></i><b>3.2.1</b> What is a list</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-types-part-2.html"><a href="data-types-part-2.html#creation-1"><i class="fa fa-check"></i><b>3.2.2</b> Creation</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-types-part-2.html"><a href="data-types-part-2.html#length"><i class="fa fa-check"></i><b>3.2.3</b> Length</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-types-part-2.html"><a href="data-types-part-2.html#getting-names-of-the-elements"><i class="fa fa-check"></i><b>3.2.4</b> Getting names of the elements</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-types-part-2.html"><a href="data-types-part-2.html#getting-a-single-element"><i class="fa fa-check"></i><b>3.2.5</b> Getting a single element</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-types-part-2.html"><a href="data-types-part-2.html#getting-multiple-elements-as-a-list"><i class="fa fa-check"></i><b>3.2.6</b> (*) Getting multiple elements as a list</a></li>
<li class="chapter" data-level="3.2.7" data-path="data-types-part-2.html"><a href="data-types-part-2.html#removing-an-element"><i class="fa fa-check"></i><b>3.2.7</b> (*) Removing an element</a></li>
<li class="chapter" data-level="3.2.8" data-path="data-types-part-2.html"><a href="data-types-part-2.html#adding-an-element"><i class="fa fa-check"></i><b>3.2.8</b> (*) Adding an element</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-types-part-2.html"><a href="data-types-part-2.html#basic-statistical-tests"><i class="fa fa-check"></i><b>3.3</b> Basic statistical tests</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-types-part-2.html"><a href="data-types-part-2.html#statistical-methods-with-r"><i class="fa fa-check"></i><b>3.3.1</b> Statistical methods with R</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-types-part-2.html"><a href="data-types-part-2.html#regression-and-formula-objects"><i class="fa fa-check"></i><b>3.4</b> Regression and formula objects</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-types-part-2.html"><a href="data-types-part-2.html#formula-objects"><i class="fa fa-check"></i><b>3.4.1</b> Formula objects</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-types-part-2.html"><a href="data-types-part-2.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.4.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-types-part-2.html"><a href="data-types-part-2.html#multiple-regression-and-prediction"><i class="fa fa-check"></i><b>3.4.3</b> Multiple regression and prediction</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-types-part-2.html"><a href="data-types-part-2.html#factors-advanced"><i class="fa fa-check"></i><b>3.5</b> Factors (advanced)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-types-part-2.html"><a href="data-types-part-2.html#factors-revisited"><i class="fa fa-check"></i><b>3.5.1</b> Factors revisited</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-types-part-2.html"><a href="data-types-part-2.html#anova-and-regression-with-factors"><i class="fa fa-check"></i><b>3.5.2</b> ANOVA and regression with factors</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-types-part-2.html"><a href="data-types-part-2.html#generalized-linear-models-and-survival"><i class="fa fa-check"></i><b>3.5.3</b> (*) Generalized linear models and survival</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#user-defined-functions"><i class="fa fa-check"></i><b>4.1</b> User-defined Functions</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#control-flow-constructs"><i class="fa fa-check"></i><b>4.2</b> (*) Control flow constructs</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="functions.html"><a href="functions.html#sequential-execution"><i class="fa fa-check"></i><b>4.2.1</b> Sequential execution</a></li>
<li class="chapter" data-level="4.2.2" data-path="functions.html"><a href="functions.html#conditional-execution-if"><i class="fa fa-check"></i><b>4.2.2</b> Conditional execution: if</a></li>
<li class="chapter" data-level="4.2.3" data-path="functions.html"><a href="functions.html#conditional-execution-ifelse"><i class="fa fa-check"></i><b>4.2.3</b> Conditional execution: if/else</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#apply-family-apply-lapply-sapply-tapply"><i class="fa fa-check"></i><b>4.3</b> <code>apply</code> family: apply, lapply, sapply, tapply</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="functions.html"><a href="functions.html#applyx-margin-fun"><i class="fa fa-check"></i><b>4.3.1</b> apply(X, MARGIN, FUN, …)</a></li>
<li class="chapter" data-level="4.3.2" data-path="functions.html"><a href="functions.html#sapplyx-fun"><i class="fa fa-check"></i><b>4.3.2</b> sapply(X, FUN, …)</a></li>
<li class="chapter" data-level="4.3.3" data-path="functions.html"><a href="functions.html#lapplyx-fun-apply-a-function-to-a-listvector"><i class="fa fa-check"></i><b>4.3.3</b> lapply(X, FUN, …) : apply a function to a list/vector</a></li>
<li class="chapter" data-level="4.3.4" data-path="functions.html"><a href="functions.html#tapplyx-index-fun-apply-a-function-to-a-vector-according-to-groups-of-index"><i class="fa fa-check"></i><b>4.3.4</b> tapply(X, INDEX, FUN, …) : apply a function to a vector, according to groups of INDEX</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="functions.html"><a href="functions.html#type-checking"><i class="fa fa-check"></i><b>4.4</b> Type checking</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="functions.html"><a href="functions.html#is.-family-functions"><i class="fa fa-check"></i><b>4.4.1</b> is.* family functions</a></li>
<li class="chapter" data-level="4.4.2" data-path="functions.html"><a href="functions.html#stopwarning"><i class="fa fa-check"></i><b>4.4.2</b> (*) stop(…)/warning(…)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="functions.html"><a href="functions.html#r-programming"><i class="fa fa-check"></i><b>4.5</b> (*) R programming</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="functions.html"><a href="functions.html#general-coding-conventions"><i class="fa fa-check"></i><b>4.5.1</b> General coding conventions</a></li>
<li class="chapter" data-level="4.5.2" data-path="functions.html"><a href="functions.html#finding-installing-and-loading-packages"><i class="fa fa-check"></i><b>4.5.2</b> Finding, installing and loading packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#character-string-processing-pattern-matching"><i class="fa fa-check"></i>Character string processing &amp; Pattern matching</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#learning-goals"><i class="fa fa-check"></i>Learning goals</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#quotes-and-escape-characters-characters-with-special-meaning"><i class="fa fa-check"></i>Quotes and escape characters (characters with special meaning)</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#character-string"><i class="fa fa-check"></i>Character string</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#paste-sep-collapse-null"><i class="fa fa-check"></i>paste(…, sep = " ", collapse = NULL):</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#pulse-data-set"><i class="fa fa-check"></i>Pulse data set</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#tolower-toupper-nchar"><i class="fa fa-check"></i>tolower, toupper, nchar</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#split-character-string-strsplitx-split"><i class="fa fa-check"></i>Split character string : strsplit(x, split, …):</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#rbind-cbind-combine-by-rows-or-columns"><i class="fa fa-check"></i>rbind(…), cbind(…) : combine by rows or columns</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#strsplitx-split"><i class="fa fa-check"></i>strsplit(x, split, …)</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#do.callwhat-args-execute-function-on-list-of-arguments"><i class="fa fa-check"></i>do.call(what, args, …) : execute function on list of arguments</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#greppattern-x-ignore.case-false-value-false"><i class="fa fa-check"></i>grep(pattern, x, ignore.case = FALSE, value = FALSE, … )</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#greplpattern-x-ignore.case-false"><i class="fa fa-check"></i>grepl(pattern, x, ignore.case = FALSE, …)</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#substrx-start-stop-extractreplace-substrings"><i class="fa fa-check"></i>substr(x, start, stop) : extract/replace substrings</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#gsubsubpattern-replacement-x-ignore.case-false"><i class="fa fa-check"></i>gsub/sub(pattern, replacement, x, ignore.case = FALSE, …)</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#extra-exercises"><i class="fa fa-check"></i>Extra exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#s3-and-s4-classes"><i class="fa fa-check"></i>S3 and S4 classes</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#learning-goals-1"><i class="fa fa-check"></i>Learning goals</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#objects"><i class="fa fa-check"></i>Objects</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#s3"><i class="fa fa-check"></i>S3</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#s4"><i class="fa fa-check"></i>S4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#making-errors-the-right-way"><i class="fa fa-check"></i>Making errors the right way</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#annoying-errors"><i class="fa fa-check"></i>Annoying errors</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#how-to-correct-annoying-errors"><i class="fa fa-check"></i>How to correct (annoying) errors</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#dangerous-errors"><i class="fa fa-check"></i>Dangerous errors</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#how-to-avoid-dangerous-errors"><i class="fa fa-check"></i>How to avoid (dangerous) errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#useful-links"><i class="fa fa-check"></i>Useful links</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using R for data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-types-part-2" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data types, part 2</h1>
<div id="r-scripts-and-reports-rmarkdown" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> R scripts and reports (Rmarkdown)</h2>
<div id="markdown-r-code-markdown-text-formating-language" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Markdown : R code + Markdown text formating language</h3>
<p>With RMarkdown you can combine text, scripts and results. This makes it easy to organize projects.</p>
<ul>
<li>RMarkdown (<a href="https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf">cheat sheet</a>) is a simple language for creating professional reports</li>
</ul>
<p>An RMarkdown document includes your R code output. Use to:</p>
<ul>
<li>share your data analysis with colleagues</li>
<li>document your data analysis for future generations</li>
</ul>
<p>The RMarkdown report can be exported in various formats: <code>html</code>, <code>pdf</code> and <code>word</code></p>
<div id="short-session" class="section level4" number="3.1.1.1">
<h4><span class="header-section-number">3.1.1.1</span> Short session</h4>
<ul>
<li>Opening a new RMarkdown file
<ul>
<li>From RStudio File -&gt; New File -&gt; R Markdown</li>
<li>Choose title and output format, choose <code>html</code> (default) here and press OK.</li>
</ul></li>
<li>Knitting (compiling R Markdown)
<ul>
<li>New RMarkdown file contains example text and code generated for you.</li>
<li>To knit, press the <code>knit</code> button in Rstudio, or use the shortcut <code>CTRL</code>+<code>Shift</code>+<code>k</code>. It first asks you to save your file. Your file will by default get extension <code>.Rmd</code></li>
</ul></li>
</ul>
<p>Quick exercises : Review the RMarkdown with the html produced. What did RMarkdown do?</p>
</div>
</div>
<div id="features-of-r-markdown" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Features of R Markdown</h3>
<div id="markdown-examples" class="section level4" number="3.1.2.1">
<h4><span class="header-section-number">3.1.2.1</span> Markdown examples</h4>
<p>Use</p>
<ul>
<li>two spaces at the end of a line for new paragraph (newline)</li>
<li>hash (<code>#</code>) for section titles.</li>
<li>dash (<code>-</code>) for bullet lists.</li>
<li>*italic*, **bold** and ~~strike through~~ for <em>italic</em>, <strong>bold</strong>, <del>strike through</del> respectively</li>
<li>&gt; to highlight</li>
</ul>
<blockquote>
<p>to highlight</p>
</blockquote>
</div>
<div id="including-r-code-in-markdown" class="section level4" number="3.1.2.2">
<h4><span class="header-section-number">3.1.2.2</span> Including R code in markdown</h4>
<p>R code is included in a <code>chunk</code>:</p>
<pre><code>```{r}
x <- 5
x + 10
```</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="data-types-part-2.html#cb416-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb416-2"><a href="data-types-part-2.html#cb416-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] 15</code></pre>
</div>
<div id="chunk-options" class="section level4" number="3.1.2.3">
<h4><span class="header-section-number">3.1.2.3</span> Chunk options</h4>
<p>There are many chunck options available, most common being <code>echo</code>, <code>eval</code>. For example the option results=‘hide’ prevents the result of the <code>x + 10</code> being included in this page:</p>
<pre><code>```{r results='hide'}
x <- 5
x + 10
```</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="data-types-part-2.html#cb418-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb418-2"><a href="data-types-part-2.html#cb418-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> <span class="dv">10</span></span></code></pre></div>
<p>And with plots</p>
<pre><code>```{r results='hide'}
with(infert, hist(age))
```</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
<div id="r-studio-and-rmarkdown" class="section level4" number="3.1.2.4">
<h4><span class="header-section-number">3.1.2.4</span> R Studio and RMarkdown</h4>
<ul>
<li>RMarkdown is well integrated with RStudio.</li>
<li>By pressing <code>knit</code> a new R session is started and terminated after generating the report.</li>
<li>This stand-alone nature helps to make sure that your analysis is <strong><em>reproducible</em></strong>.</li>
<li>The working directory of the markdown R session is the location of the markdown document.</li>
<li>The knitting R session is independent from the R session in the RStudio console, this means that:
<ul>
<li>All data needed for the generation of the report must be loaded/created by the scripts in the R Markdown document.</li>
<li>and conversely no data from R session in the R Studio console is accessible by the R session started for knitting.</li>
</ul></li>
<li>It is possible to run a block of R code from R Markdown document inside the R Studio console.</li>
<li>etc.</li>
</ul>
</div>
<div id="try-this" class="section level4" number="3.1.2.5">
<h4><span class="header-section-number">3.1.2.5</span> Try this!</h4>
<p>From now on, work only with RMarkdown for this course.</p>
</div>
</div>
</div>
<div id="lists" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Lists</h2>
<div id="what-is-a-list" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> What is a list</h3>
<p>A <a href="http://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects">list</a> can be thought of as zero or more (named) cells containing data of <em>any type</em>.</p>
<p>Elements may be named.</p>
<p>Elements are accessed through indexing operations.</p>
<center>
<img src="figure/Data_types_mdfl.png" title="fig:" alt="Lists" />
</center>
</div>
<div id="creation-1" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Creation</h3>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="data-types-part-2.html#cb419-1" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">list</span>(            <span class="co"># here = or &lt;-</span></span>
<span id="cb419-2"><a href="data-types-part-2.html#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;Bob&quot;</span>,           <span class="co"># but here only =</span></span>
<span id="cb419-3"><a href="data-types-part-2.html#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="dv">44</span>,               <span class="co"># never &lt;-</span></span>
<span id="cb419-4"><a href="data-types-part-2.html#cb419-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">children =</span> <span class="fu">c</span>( <span class="st">&quot;Amy&quot;</span>, <span class="st">&quot;Dan&quot;</span>, <span class="st">&quot;Eve&quot;</span> )</span>
<span id="cb419-5"><a href="data-types-part-2.html#cb419-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-6"><a href="data-types-part-2.html#cb419-6" aria-hidden="true" tabindex="-1"></a>study</span></code></pre></div>
<pre><code>## $name
## [1] &quot;Bob&quot;
## 
## $age
## [1] 44
## 
## $children
## [1] &quot;Amy&quot; &quot;Dan&quot; &quot;Eve&quot;</code></pre>
<p>The class of <code>study</code>:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="data-types-part-2.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( study )</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>Function <code>str</code> gives a compact display of an object structure/content:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="data-types-part-2.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>( study )</span></code></pre></div>
<pre><code>## List of 3
##  $ name    : chr &quot;Bob&quot;
##  $ age     : num 44
##  $ children: chr [1:3] &quot;Amy&quot; &quot;Dan&quot; &quot;Eve&quot;</code></pre>
</div>
<div id="length" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Length</h3>
<p>Length of the list (number of elements):</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="data-types-part-2.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>( study )</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
</div>
<div id="getting-names-of-the-elements" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Getting names of the elements</h3>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="data-types-part-2.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>( study )</span></code></pre></div>
<pre><code>## [1] &quot;name&quot;     &quot;age&quot;      &quot;children&quot;</code></pre>
</div>
<div id="getting-a-single-element" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Getting a single element</h3>
<p>Single elements can be accessed by their names in the list:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="data-types-part-2.html#cb429-1" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>age</span></code></pre></div>
<pre><code>## [1] 44</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="data-types-part-2.html#cb431-1" aria-hidden="true" tabindex="-1"></a>study[[ <span class="st">&quot;age&quot;</span> ]]</span></code></pre></div>
<pre><code>## [1] 44</code></pre>
<p>Note the double [[.</p>
<p>The type of the returned element depends on the element:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="data-types-part-2.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( study<span class="sc">$</span>age )</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="data-types-part-2.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( study<span class="sc">$</span>children )</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Nonexisting elements will give <code>NULL</code></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="data-types-part-2.html#cb437-1" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>parents</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>It is also possible to access elements by numerical index:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="data-types-part-2.html#cb439-1" aria-hidden="true" tabindex="-1"></a>study[[ <span class="dv">2</span> ]]</span></code></pre></div>
<pre><code>## [1] 44</code></pre>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="01_lists.tasks.nocode.html#createList">the task(s)</a>, and check your solution(s) <a href="01_lists.tasks.code.html#createList">here</a>.</p>
</blockquote>
<hr />
</div>
<div id="getting-multiple-elements-as-a-list" class="section level3" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> (*) Getting multiple elements as a list</h3>
<p>To get (possibly) multiple elements use single brackets notation:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="data-types-part-2.html#cb441-1" aria-hidden="true" tabindex="-1"></a>study[ <span class="fu">c</span>( <span class="st">&quot;age&quot;</span>, <span class="st">&quot;children&quot;</span> ) ]</span></code></pre></div>
<pre><code>## $age
## [1] 44
## 
## $children
## [1] &quot;Amy&quot; &quot;Dan&quot; &quot;Eve&quot;</code></pre>
<p>Note the difference:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="data-types-part-2.html#cb443-1" aria-hidden="true" tabindex="-1"></a>study[[ <span class="st">&quot;age&quot;</span> ]]</span></code></pre></div>
<pre><code>## [1] 44</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="data-types-part-2.html#cb445-1" aria-hidden="true" tabindex="-1"></a>study[ <span class="st">&quot;age&quot;</span> ]</span></code></pre></div>
<pre><code>## $age
## [1] 44</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="data-types-part-2.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( study[[ <span class="st">&quot;age&quot;</span> ]] )</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="data-types-part-2.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( study[ <span class="st">&quot;age&quot;</span> ] )</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>Accessing nonexisting elements with single brackets:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="data-types-part-2.html#cb451-1" aria-hidden="true" tabindex="-1"></a>study[ <span class="st">&quot;parents&quot;</span> ]</span></code></pre></div>
<pre><code>## $&lt;NA&gt;
## NULL</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="data-types-part-2.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>( study[ <span class="st">&quot;parents&quot;</span> ] )</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="data-types-part-2.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>( study[ <span class="st">&quot;parents&quot;</span> ] )</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="data-types-part-2.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.null</span>( study[ <span class="st">&quot;parents&quot;</span> ] )</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Numerical or logical indices may be also used:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="data-types-part-2.html#cb459-1" aria-hidden="true" tabindex="-1"></a>study[ <span class="fu">c</span>( <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span> ) ]</span></code></pre></div>
<pre><code>## $children
## [1] &quot;Amy&quot; &quot;Dan&quot; &quot;Eve&quot;
## 
## $name
## [1] &quot;Bob&quot;
## 
## $name
## [1] &quot;Bob&quot;</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="data-types-part-2.html#cb461-1" aria-hidden="true" tabindex="-1"></a>study[ <span class="fu">c</span>( T, F, T ) ]</span></code></pre></div>
<pre><code>## $name
## [1] &quot;Bob&quot;
## 
## $children
## [1] &quot;Amy&quot; &quot;Dan&quot; &quot;Eve&quot;</code></pre>
</div>
<div id="removing-an-element" class="section level3" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> (*) Removing an element</h3>
<p>A list element is removed by setting to NULL:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="data-types-part-2.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>( study )</span></code></pre></div>
<pre><code>## List of 3
##  $ name    : chr &quot;Bob&quot;
##  $ age     : num 44
##  $ children: chr [1:3] &quot;Amy&quot; &quot;Dan&quot; &quot;Eve&quot;</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="data-types-part-2.html#cb465-1" aria-hidden="true" tabindex="-1"></a>study[[ <span class="st">&quot;children&quot;</span> ]] <span class="ot">&lt;-</span> <span class="cn">NULL</span>;   <span class="co"># NULL means &quot;nothing&quot;</span></span>
<span id="cb465-2"><a href="data-types-part-2.html#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>( study )</span></code></pre></div>
<pre><code>## List of 2
##  $ name: chr &quot;Bob&quot;
##  $ age : num 44</code></pre>
</div>
<div id="adding-an-element" class="section level3" number="3.2.8">
<h3><span class="header-section-number">3.2.8</span> (*) Adding an element</h3>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="data-types-part-2.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>( study )</span></code></pre></div>
<pre><code>## List of 2
##  $ name: chr &quot;Bob&quot;
##  $ age : num 44</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="data-types-part-2.html#cb469-1" aria-hidden="true" tabindex="-1"></a>study<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="st">&quot;male&quot;</span></span>
<span id="cb469-2"><a href="data-types-part-2.html#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>( study )</span></code></pre></div>
<pre><code>## List of 3
##  $ name  : chr &quot;Bob&quot;
##  $ age   : num 44
##  $ gender: chr &quot;male&quot;</code></pre>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="01_lists.tasks.nocode.html#elementsList">the task(s)</a>, and check your solution(s) <a href="01_lists.tasks.code.html#elementsList">here</a>.</p>
</blockquote>
<hr />
</div>
</div>
<div id="basic-statistical-tests" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Basic statistical tests</h2>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="data-types-part-2.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="do">## pulse &lt;- read.delim(&quot;pulse.txt&quot;)</span></span>
<span id="cb471-2"><a href="data-types-part-2.html#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="do">## survey &lt;- read.delim(&quot;survey.txt&quot;)</span></span></code></pre></div>
<div id="statistical-methods-with-r" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Statistical methods with R</h3>
<p>Statistical methods typically have their own pre-defined functions. Example: the t-test.</p>
<div id="statistical-tests---the-t-test" class="section level4" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> Statistical tests - the t test</h4>
<p>Suppose we are interested in finding a difference between <code>pulse1</code> and <code>pulse2</code> in the pulse data. These are two variables representing measurements per individual before (pulse1) and after (pulse2) an intervention. As such, measurements are paired so we apply a paired t test:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="data-types-part-2.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(pulse<span class="sc">$</span>pulse1, pulse<span class="sc">$</span>pulse2, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  pulse$pulse1 and pulse$pulse2
## t = -7.4726, df = 108, p-value = 2.172e-11
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -26.70969 -15.51049
## sample estimates:
## mean of the differences 
##               -21.11009</code></pre>
</div>
<div id="accessing-the-result" class="section level4" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> Accessing the result</h4>
<p>The output on the screen is clear. But sometimes we want to extract parts of the output, say to put in a report, without having to include the entire output of the test. To do that, let us first save the result as an R object, and then check what it contains by using names().</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="data-types-part-2.html#cb474-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">t.test</span>(pulse<span class="sc">$</span>pulse1, pulse<span class="sc">$</span>pulse2, <span class="at">paired=</span><span class="cn">TRUE</span>)</span>
<span id="cb474-2"><a href="data-types-part-2.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res)</span></code></pre></div>
<pre><code>##  [1] &quot;statistic&quot;   &quot;parameter&quot;   &quot;p.value&quot;     &quot;conf.int&quot;    &quot;estimate&quot;   
##  [6] &quot;null.value&quot;  &quot;stderr&quot;      &quot;alternative&quot; &quot;method&quot;      &quot;data.name&quot;</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="data-types-part-2.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(res)</span></code></pre></div>
<pre><code>## [1] &quot;htest&quot;</code></pre>
<p>Note that the resulting object of <code>t.test</code> is a special type of object. It contains various components, including statistic and parameter. Each can be assessed by using a <code>$</code> sign, as in:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="data-types-part-2.html#cb478-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>statistic</span></code></pre></div>
<pre><code>##         t 
## -7.472648</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="data-types-part-2.html#cb480-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 2.171529e-11</code></pre>
<p>Note in particular that elements in this result involve different types and lengths. Indeed:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="data-types-part-2.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(res<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="data-types-part-2.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(res<span class="sc">$</span>alternative)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="data-types-part-2.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(res<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="data-types-part-2.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(res<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>This means that the object resulting from the t.test function is a list too.</p>
</div>
<div id="wilcoxon-test" class="section level4" number="3.3.1.3">
<h4><span class="header-section-number">3.3.1.3</span> Wilcoxon test</h4>
<p>Similarly to what we did above, we can apply a Wilcoxon test for these paired measurements and save results as an object. This can be done using:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="data-types-part-2.html#cb490-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(pulse<span class="sc">$</span>pulse1, pulse<span class="sc">$</span>pulse2, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Note that the syntax is the same as the one used for the t test.</p>
<p>We can also assess names and the class of the object created by the Wilcoxon test:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="data-types-part-2.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res)</span></code></pre></div>
<pre><code>## [1] &quot;statistic&quot;   &quot;parameter&quot;   &quot;p.value&quot;     &quot;null.value&quot;  &quot;alternative&quot;
## [6] &quot;method&quot;      &quot;data.name&quot;</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="data-types-part-2.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(res)</span></code></pre></div>
<pre><code>## [1] &quot;htest&quot;</code></pre>
<p>Note that the class of the object created by the wilcox.test function is the same as that for the object created by the t.test function.</p>
</div>
<div id="other-statistical-tests" class="section level4" number="3.3.1.4">
<h4><span class="header-section-number">3.3.1.4</span> Other statistical tests</h4>
<p>Other basic tests available include:</p>
<ul>
<li><code>chisq.test</code></li>
<li><code>fisher.test</code></li>
<li><code>binom.test</code></li>
</ul>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="02_S3_objects.tasks.nocode.html#S3">the task(s)</a>, and check your solution(s) <a href="02_S3_objects.tasks.code.html#S3">here</a>.</p>
</blockquote>
<hr />
</div>
</div>
</div>
<div id="regression-and-formula-objects" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Regression and formula objects</h2>
<div id="formula-objects" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Formula objects</h3>
<p>Formula objects are the way to tell R that one variable depends on another.</p>
<div id="basics-of-formula-objects" class="section level4" number="3.4.1.1">
<h4><span class="header-section-number">3.4.1.1</span> Basics of formula objects</h4>
<p>To specify a (statistical) model in which <code>y</code> depends on <code>x</code>, say</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="data-types-part-2.html#cb495-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x</span></code></pre></div>
<pre><code>## y ~ x</code></pre>
<p>We use a formula for more readable specification of code. For example, when plotting. Instead of</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="data-types-part-2.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pulse<span class="sc">$</span>pulse1, pulse<span class="sc">$</span>pulse2)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
<p>we say</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="data-types-part-2.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pulse2 <span class="sc">~</span> pulse1, <span class="at">data=</span>pulse)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
<p>Note the reverse order!</p>
<p>If a function allows a formula as input it always has a <code>data</code> argument. This gives the data.frame (or other environment) in which the variables in the formula are interpreted.</p>
</div>
<div id="use-of-formula-objects-in-statistics" class="section level4" number="3.4.1.2">
<h4><span class="header-section-number">3.4.1.2</span> Use of formula objects in statistics</h4>
<p>Formula objects can also be used in the syntax of tests and other functions, making them simpler. For example, consider the problem of comparing values of <code>pulse1</code> between males and females. We can use an unpaired t test for this, by writing:</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="data-types-part-2.html#cb499-1" aria-hidden="true" tabindex="-1"></a>pulse1.male <span class="ot">&lt;-</span> pulse<span class="sc">$</span>pulse1[survey<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&#39;male&#39;</span>]</span>
<span id="cb499-2"><a href="data-types-part-2.html#cb499-2" aria-hidden="true" tabindex="-1"></a>pulse1.female <span class="ot">&lt;-</span> pulse<span class="sc">$</span>pulse1[survey<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&#39;female&#39;</span>]</span>
<span id="cb499-3"><a href="data-types-part-2.html#cb499-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(pulse1.male, pulse1.female)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  pulse1.male and pulse1.female
## t = 0.25755, df = 99.399, p-value = 0.7973
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -4.469216  5.802550
## sample estimates:
## mean of x mean of y 
##  76.00000  75.33333</code></pre>
<p>A much simpler way is to use a formula:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="data-types-part-2.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(pulse1 <span class="sc">~</span> gender, <span class="at">data =</span> pulse)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  pulse1 by gender
## t = 1.3234, df = 106.3, p-value = 0.1885
## alternative hypothesis: true difference in means between group female and group male is not equal to 0
## 95 percent confidence interval:
##  -1.667268  8.362184
## sample estimates:
## mean in group female   mean in group male 
##             77.50000             74.15254</code></pre>
<p>Many functions allow (or require!) formula as input.</p>
</div>
<div id="the-formula-class" class="section level4" number="3.4.1.3">
<h4><span class="header-section-number">3.4.1.3</span> (*) The formula class</h4>
<p>A formula is just a R object.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="data-types-part-2.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y<span class="sc">~</span>x)</span></code></pre></div>
<pre><code>## [1] &quot;formula&quot;</code></pre>
<p>It can be stored in a variable and reused.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="data-types-part-2.html#cb505-1" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> pulse1 <span class="sc">~</span> gender</span>
<span id="cb505-2"><a href="data-types-part-2.html#cb505-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(form, <span class="at">data=</span>pulse)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  pulse1 by gender
## t = 1.3234, df = 106.3, p-value = 0.1885
## alternative hypothesis: true difference in means between group female and group male is not equal to 0
## 95 percent confidence interval:
##  -1.667268  8.362184
## sample estimates:
## mean in group female   mean in group male 
##             77.50000             74.15254</code></pre>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="03_regression.tasks.nocode.html#formula">the task(s)</a>, and check your solution(s) <a href="03_regression.tasks.code.html#formula">here</a>.</p>
</blockquote>
<hr />
</div>
</div>
<div id="simple-linear-regression" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Simple linear regression</h3>
<div id="the-lm-function" class="section level4" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> The <code>lm</code> function</h4>
<p>The command for linear regression is <code>lm</code> (for <em>linear model</em>). The linear model returns an object of class <code>lm</code>.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="data-types-part-2.html#cb507-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> pulse)</span></code></pre></div>
<p>The output of <code>lm</code> is an object of class <code>lm</code>.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="data-types-part-2.html#cb508-1" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ height, data = pulse)
## 
## Coefficients:
## (Intercept)       height  
##    -27.4398       0.5465</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="data-types-part-2.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fit)</span></code></pre></div>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<p>Some S3 objects have special functions defined for them. The following functions extract useful information from the <code>lm</code> object.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="data-types-part-2.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ height, data = pulse)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -17.549  -8.197  -2.601   5.469  53.277 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -27.43977   12.73858  -2.154   0.0335 *  
## height        0.54651    0.07392   7.393 3.23e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.41 on 108 degrees of freedom
## Multiple R-squared:  0.336,  Adjusted R-squared:  0.3299 
## F-statistic: 54.66 on 1 and 108 DF,  p-value: 3.231e-11</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="data-types-part-2.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span></code></pre></div>
<pre><code>## (Intercept)      height 
## -27.4397668   0.5465124</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="data-types-part-2.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit)</span></code></pre></div>
<pre><code>##      1993_A      1993_B      1993_C      1993_D      1993_E      1993_F 
## -10.1068721 -12.3859463  -1.8277979   4.8698559  -3.1068721   0.8814919 
##      1993_G      1993_H      1993_I      1993_J      1993_K      1993_L 
##  -4.0952361  -9.9208226  -6.1882608  -4.3743103   9.5326650 -11.8394339 
##      1993_M      1993_N      1993_O      1993_P      1993_Q      1993_R 
##   2.5326650 -15.7580452   1.0675414  36.3349796  -9.4673350  -0.9324586 
##      1993_S      1993_T      1993_U      1993_V      1993_W      1993_X 
##  -7.2812855  -7.2696495  -8.1998968   0.9280359  -6.6417484   2.9745167 
##      1993_Y      1993_Z      1995_A      1995_B      1995_C      1995_D 
##  -9.7464092   4.7070785  -5.4673350  -6.5603597 -15.8510699 -13.8394339 
##      1995_E      1995_F      1995_G      1995_H      1995_I      1995_J 
##   6.8001032  14.0675414  -3.0022114   3.8117392  -3.1998968  -6.6417484 
##      1995_K      1995_L      1995_M      1995_N      1995_O      1995_P 
##  16.3349796   3.0791774   0.2652268  -8.2696495  -2.1998968  -6.8394339 
##      1995_Q      1995_R      1995_S      1995_T      1995_U      1995_V 
##  -8.1185081  -5.4673350  -1.0952361 -16.1882608   3.9861526  12.9745167 
##      1996_A      1996_B      1996_C      1996_D      1996_E      1996_F 
##  -7.6533844   6.1722021 -17.3626743   0.4280043  11.1722021   0.9861526 
##      1996_G      1996_H      1996_I      1996_J      1996_K      1996_L 
##  -9.0254833   2.8931279  12.9745167  -7.9091866 -11.0022114   4.0675414 
##      1996_M      1996_N      1996_O      1996_P      1996_Q      1996_R 
##   6.0675414  11.6954425  -8.1882608  31.0675414  -7.8394339 -13.2812855 
##      1996_S      1996_T      1996_U      1997_A      1997_B      1997_C 
## -11.1998968   9.0675414  25.9745167 -13.0836001  12.7884672   5.6024177 
##      1997_D      1997_E      1997_F      1997_G      1997_H      1997_I 
##   9.6140537 -14.7347732 -13.5603597  -3.1068721 -11.9673350  -6.9673350 
##      1997_J      1997_K      1997_L      1997_M      1997_N      1997_O 
## -10.6417484   1.0559054  -7.5603597   4.9861526   5.0675414  31.4163683 
##      1997_P      1997_Q      1997_R      1997_S      1997_T      1997_U 
##  -0.8277979  27.5093930  16.4163683  12.1489301 -11.0952361 -14.1998968 
##      1997_V      1997_W      1998_A      1998_B      1998_C      1998_D 
##  10.3001032  21.7884672  16.1605661  -7.4673350  -4.7347732  15.8117392 
##      1998_E      1998_F      1998_G      1998_H      1998_I      1998_J 
##  -5.9324586  -3.4673350  -2.2696495  -2.7347732  -9.3743103  53.2769261 
##      1998_K      1998_L      1998_M      1998_N      1998_O      1998_P 
##  -2.4673350   9.6140537 -14.6417484   3.6141170 -17.5487237 -12.0254833 
##      1998_Q      1998_R 
##  -0.4673350  11.3349796</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="data-types-part-2.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted.values</span>(fit)</span></code></pre></div>
<pre><code>##    1993_A    1993_B    1993_C    1993_D    1993_E    1993_F    1993_G    1993_H 
## 67.106872 70.385946 63.827798 79.130144 67.106872 73.118508 61.095236 64.920823 
##    1993_I    1993_J    1993_K    1993_L    1993_M    1993_N    1993_O    1993_P 
## 62.188261 64.374310 65.467335 69.839434 65.467335 74.758045 70.932459 73.665020 
##    1993_Q    1993_R    1993_S    1993_T    1993_U    1993_V    1993_W    1993_X 
## 65.467335 70.932459 63.281286 57.269650 68.199897 49.071964 61.641748 72.025483 
##    1993_Y    1993_Z    1995_A    1995_B    1995_C    1995_D    1995_E    1995_F 
## 68.746409 69.292922 65.467335 66.560360 75.851070 69.839434 68.199897 70.932459 
##    1995_G    1995_H    1995_I    1995_J    1995_K    1995_L    1995_M    1995_N 
## 60.002211 62.188261 68.199897 61.641748 73.665020 64.920823 62.734773 57.269650 
##    1995_O    1995_P    1995_Q    1995_R    1995_S    1995_T    1995_U    1995_V 
## 68.199897 69.839434 73.118508 65.467335 61.095236 62.188261 66.013847 72.025483 
##    1996_A    1996_B    1996_C    1996_D    1996_E    1996_F    1996_G    1996_H 
## 67.653384 63.827798 58.362674 72.571996 63.827798 66.013847 72.025483 67.106872 
##    1996_I    1996_J    1996_K    1996_L    1996_M    1996_N    1996_O    1996_P 
## 72.025483 58.909187 60.002211 70.932459 70.932459 75.304558 62.188261 70.932459 
##    1996_Q    1996_R    1996_S    1996_T    1996_U    1997_A    1997_B    1997_C 
## 69.839434 63.281286 68.199897 70.932459 72.025483 55.083600 74.211533 76.397582 
##    1997_D    1997_E    1997_F    1997_G    1997_H    1997_I    1997_J    1997_K 
## 70.385946 62.734773 66.560360 67.106872 65.467335 65.467335 61.641748 76.944095 
##    1997_L    1997_M    1997_N    1997_O    1997_P    1997_Q    1997_R    1997_S 
## 66.560360 66.013847 70.932459 78.583632 63.827798 77.490607 78.583632 75.851070 
##    1997_T    1997_U    1997_V    1997_W    1998_A    1998_B    1998_C    1998_D 
## 61.095236 68.199897 68.199897 74.211533 69.839434 65.467335 62.734773 62.188261 
##    1998_E    1998_F    1998_G    1998_H    1998_I    1998_J    1998_K    1998_L 
## 70.932459 65.467335 57.269650 62.734773 64.374310  9.723074 65.467335 70.385946 
##    1998_M    1998_N    1998_O    1998_P    1998_Q    1998_R 
## 61.641748 23.385883 60.548724 72.025483 65.467335 73.665020</code></pre>
<p>Note that <code>summary(fit)</code> returns itself an object in which some additional things are calculated.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="data-types-part-2.html#cb520-1" aria-hidden="true" tabindex="-1"></a>summa <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb520-2"><a href="data-types-part-2.html#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(summa)</span></code></pre></div>
<pre><code>## [1] &quot;summary.lm&quot;</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="data-types-part-2.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(summa)</span></code></pre></div>
<pre><code>##  [1] &quot;call&quot;          &quot;terms&quot;         &quot;residuals&quot;     &quot;coefficients&quot; 
##  [5] &quot;aliased&quot;       &quot;sigma&quot;         &quot;df&quot;            &quot;r.squared&quot;    
##  [9] &quot;adj.r.squared&quot; &quot;fstatistic&quot;    &quot;cov.unscaled&quot;</code></pre>
<p>Most useful is the regression table</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="data-types-part-2.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(summa)</span></code></pre></div>
<pre><code>##                Estimate  Std. Error   t value     Pr(&gt;|t|)
## (Intercept) -27.4397668 12.73857886 -2.154068 3.345796e-02
## height        0.5465124  0.07392117  7.393178 3.231467e-11</code></pre>
<p>and the confidence intervals for all or some regression coefficients</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="data-types-part-2.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit)</span></code></pre></div>
<pre><code>##                   2.5 %     97.5 %
## (Intercept) -52.6898400 -2.1896935
## height        0.3999878  0.6930369</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="data-types-part-2.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit, <span class="st">&quot;height&quot;</span>)</span></code></pre></div>
<pre><code>##            2.5 %    97.5 %
## height 0.3999878 0.6930369</code></pre>
</div>
<div id="visualizing-a-regression" class="section level4" number="3.4.2.2">
<h4><span class="header-section-number">3.4.2.2</span> Visualizing a regression</h4>
<p>We can easily visualize the regression using the same formula and fit object</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="data-types-part-2.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight <span class="sc">~</span> height, <span class="at">data=</span>pulse)</span>
<span id="cb530-2"><a href="data-types-part-2.html#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(fit))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="03_regression.tasks.nocode.html#lm">the task(s)</a>, and check your solution(s) <a href="03_regression.tasks.code.html#lm">here</a>.</p>
</blockquote>
<hr />
</div>
</div>
<div id="multiple-regression-and-prediction" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Multiple regression and prediction</h3>
<div id="multiple-terms-in-a-formula" class="section level4" number="3.4.3.1">
<h4><span class="header-section-number">3.4.3.1</span> Multiple terms in a formula</h4>
<p>We can have multiple terms in a formula. This way we can do multiple regression</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="data-types-part-2.html#cb531-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(pulse2 <span class="sc">~</span> pulse1 <span class="sc">+</span> height, <span class="at">data=</span>pulse)</span>
<span id="cb531-2"><a href="data-types-part-2.html#cb531-2" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ pulse1 + height, data = pulse)
## 
## Coefficients:
## (Intercept)       pulse1       height  
##    25.96489      0.86822      0.02984</code></pre>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="data-types-part-2.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ pulse1 + height, data = pulse)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -28.89 -23.05 -17.84  28.40  72.89 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 25.96489   39.90679   0.651 0.516688    
## pulse1       0.86822    0.22380   3.879 0.000182 ***
## height       0.02984    0.18427   0.162 0.871668    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 29.71 on 106 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.1309, Adjusted R-squared:  0.1145 
## F-statistic: 7.981 on 2 and 106 DF,  p-value: 0.0005904</code></pre>
</div>
<div id="predicting" class="section level4" number="3.4.3.2">
<h4><span class="header-section-number">3.4.3.2</span> Predicting</h4>
<p>We can use regression for prediction using the predict function. To predict we need two things. First, a fitted model object.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="data-types-part-2.html#cb535-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(pulse2 <span class="sc">~</span> pulse1 <span class="sc">+</span> height, <span class="at">data=</span>pulse)</span></code></pre></div>
<p>Second, a data.frame with new data for our covariates</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="data-types-part-2.html#cb536-1" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pulse1=</span><span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">80</span>), <span class="at">height=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">173</span>, <span class="dv">185</span>)))</span></code></pre></div>
<p>Now we can predict a value for a person with these covariates</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="data-types-part-2.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, new.data)</span></code></pre></div>
<pre><code>##        1        2 
## 109.2668 100.9426</code></pre>
</div>
<div id="interaction" class="section level4" number="3.4.3.3">
<h4><span class="header-section-number">3.4.3.3</span> (*) Interaction</h4>
<p>Specifying interactions between variables in a formula: use <code>:</code> or <code>*</code>:</p>
<ul>
<li><code>:</code> interaction only</li>
<li><code>*</code> interaction and main effects</li>
</ul>
<p>Let us say that we want to explain <code>pulse2</code> by <code>pulse1</code>, <code>exercise</code> and <code>alcohol</code>, as well as a variable representing an interaction between <code>exercise</code> and <code>alcohol</code>. Two alternative ways of specifying the same model are</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="data-types-part-2.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(pulse2 <span class="sc">~</span> pulse1 <span class="sc">+</span> exercise <span class="sc">+</span> alcohol <span class="sc">+</span> exercise<span class="sc">:</span>alcohol, <span class="at">data=</span>pulse)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ pulse1 + exercise + alcohol + exercise:alcohol, 
##     data = pulse)
## 
## Coefficients:
##                 (Intercept)                       pulse1  
##                      6.0581                       0.8911  
##                 exerciselow             exercisemoderate  
##                     17.6346                      24.1769  
##                  alcoholyes       exerciselow:alcoholyes  
##                     28.4487                     -21.3348  
## exercisemoderate:alcoholyes  
##                    -28.8261</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="data-types-part-2.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(pulse2 <span class="sc">~</span> pulse1 <span class="sc">+</span> exercise<span class="sc">*</span>alcohol, <span class="at">data=</span>pulse)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ pulse1 + exercise * alcohol, data = pulse)
## 
## Coefficients:
##                 (Intercept)                       pulse1  
##                      6.0581                       0.8911  
##                 exerciselow             exercisemoderate  
##                     17.6346                      24.1769  
##                  alcoholyes       exerciselow:alcoholyes  
##                     28.4487                     -21.3348  
## exercisemoderate:alcoholyes  
##                    -28.8261</code></pre>
</div>
<div id="the-intercept-term" class="section level4" number="3.4.3.4">
<h4><span class="header-section-number">3.4.3.4</span> (*) The intercept term</h4>
<p>We see that R automatically adds an intercept term to the model. You can suppress the intercept too, by adding either <code>+0</code> or <code>-1</code> to the formula. Suppressing the intercept has different effects if there are factor variables in your model or not.</p>
<p>Suppression of the intercept means regression through the origin</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="data-types-part-2.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(weight <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> height, <span class="at">data=</span>pulse)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ 0 + height, data = pulse)
## 
## Coefficients:
## height  
##  0.388</code></pre>
<p>Note that this is different if we have factors (see next part)!</p>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="03_regression.tasks.nocode.html#multiple">the task(s)</a>, and check your solution(s) <a href="03_regression.tasks.code.html#multiple">here</a>.</p>
</blockquote>
<hr />
</div>
</div>
</div>
<div id="factors-advanced" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Factors (advanced)</h2>
<div id="factors-revisited" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Factors revisited</h3>
<p>We have seen an introduction to factors in the section ‘Basic data types’. Remember that they are variables that define categories. We can find out the category names involved using <code>levels</code> and tabulate factors:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="data-types-part-2.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="data-types-part-2.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<pre><code>## 
##     high      low moderate 
##       14       37       59</code></pre>
<p>Note that the category names given by its levels come typically in alphabetical order. In the example above, this order does not correspond to the intrinsic order of the categories, in which the extremes are given by <code>high</code> and <code>low</code>, with <code>intermediate</code> in the middle, rather than the last one. This is not a big problem for a table, but it is not ideal for a graph. Indeed, a boxplot of <code>pulse2</code> according to the groups defined by <code>exercise</code> looks like:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="data-types-part-2.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pulse<span class="sc">$</span>pulse2 <span class="sc">~</span> pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>So we would like to re-order the factor levels so that they correspond to the intrinsic order of the categories.</p>
<div id="reordering-a-factor" class="section level4" number="3.5.1.1">
<h4><span class="header-section-number">3.5.1.1</span> Reordering a factor</h4>
<p>To change the order of the category levels, we create the factor again by giving its levels in the correct order:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="data-types-part-2.html#cb550-1" aria-hidden="true" tabindex="-1"></a>pulse<span class="sc">$</span>exercise <span class="ot">&lt;-</span> <span class="fu">factor</span>(pulse<span class="sc">$</span>exercise, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&#39;high&#39;</span>, <span class="st">&#39;moderate&#39;</span>, <span class="st">&#39;low&#39;</span>))</span></code></pre></div>
<p>We can check that the re-ordering has worked:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="data-types-part-2.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<pre><code>## [1] &quot;high&quot;     &quot;moderate&quot; &quot;low&quot;</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="data-types-part-2.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<pre><code>## 
##     high moderate      low 
##       14       59       37</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="data-types-part-2.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pulse<span class="sc">$</span>pulse2 <span class="sc">~</span> pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
</div>
<div id="changing-factor-labels" class="section level4" number="3.5.1.2">
<h4><span class="header-section-number">3.5.1.2</span> Changing factor labels</h4>
<p>If you want to change the category labels only, without re-ordering them, assign new values to the <code>levels</code> of a factor.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="data-types-part-2.html#cb556-1" aria-hidden="true" tabindex="-1"></a>pulse<span class="sc">$</span>exercise2 <span class="ot">&lt;-</span> pulse<span class="sc">$</span>exercise</span>
<span id="cb556-2"><a href="data-types-part-2.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(pulse<span class="sc">$</span>exercise2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;L&quot;</span>)</span>
<span id="cb556-3"><a href="data-types-part-2.html#cb556-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pulse<span class="sc">$</span>exercise2)</span></code></pre></div>
<pre><code>## 
##  H  I  L 
## 14 59 37</code></pre>
<p>We can use similar code to merge categories of a factor. For example, to merge the categories <code>H</code> and <code>I</code>, assign to them the same label:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="data-types-part-2.html#cb558-1" aria-hidden="true" tabindex="-1"></a>pulse<span class="sc">$</span>exercise3 <span class="ot">&lt;-</span> pulse<span class="sc">$</span>exercise</span>
<span id="cb558-2"><a href="data-types-part-2.html#cb558-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(pulse<span class="sc">$</span>exercise3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H.I&quot;</span>, <span class="st">&quot;H.I&quot;</span> , <span class="st">&quot;L&quot;</span>)</span></code></pre></div>
</div>
<div id="turning-a-continuous-variable-into-categories" class="section level4" number="3.5.1.3">
<h4><span class="header-section-number">3.5.1.3</span> Turning a continuous variable into categories</h4>
<p>Use <code>cut</code> to categorise a continuous variable and turn into a factor variable. Note that when calling <code>cut</code> the break points between categories need to be given, including the maximum and minimum values of the original variable.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="data-types-part-2.html#cb559-1" aria-hidden="true" tabindex="-1"></a>pulse<span class="sc">$</span>height4 <span class="ot">&lt;-</span> <span class="fu">cut</span>(pulse<span class="sc">$</span>height, <span class="fu">c</span>(<span class="fu">min</span>(pulse<span class="sc">$</span>height)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">180</span>, <span class="fu">max</span>(pulse<span class="sc">$</span>height)))</span>
<span id="cb559-2"><a href="data-types-part-2.html#cb559-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(pulse<span class="sc">$</span>height4)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="data-types-part-2.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pulse<span class="sc">$</span>height4)</span></code></pre></div>
<pre><code>## 
##  (67,160] (160,170] (170,180] (180,195] 
##        11        38        37        24</code></pre>
<p>You may want to change the labels to something prettier.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="data-types-part-2.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(pulse<span class="sc">$</span>height4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;-160&#39;</span>, <span class="st">&#39;160-170&#39;</span>, <span class="st">&#39;170-180&#39;</span>, <span class="st">&#39;180+&#39;</span>)</span>
<span id="cb563-2"><a href="data-types-part-2.html#cb563-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pulse<span class="sc">$</span>height4)</span></code></pre></div>
<pre><code>## 
##    -160 160-170 170-180    180+ 
##      11      38      37      24</code></pre>
</div>
<div id="combining-factors" class="section level4" number="3.5.1.4">
<h4><span class="header-section-number">3.5.1.4</span> (*) Combining factors</h4>
<p>The <code>:</code> operator can be used to make a new factor with all combinations of two (or more) factors</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="data-types-part-2.html#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pulse$smokes:pulse$alcohol</span></span></code></pre></div>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="04_advanced_factors.tasks.nocode.html#levels">the task(s)</a>, and check your solution(s) <a href="04_advanced_factors.tasks.code.html#levels">here</a>.</p>
</blockquote>
<hr />
</div>
</div>
<div id="anova-and-regression-with-factors" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> ANOVA and regression with factors</h3>
<p>An ANOVA analysis can be run in R by using the results of a regression model fit, such as from <code>lm</code>.</p>
<div id="regression-model-fit" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Regression model fit</h4>
<p>Say you fit a regression model of <code>pulse2</code> on <code>exercise</code>, which already had its categories reordered:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="data-types-part-2.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pulse<span class="sc">$</span>exercise)</span></code></pre></div>
<pre><code>## 
##     high moderate      low 
##       14       59       37</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="data-types-part-2.html#cb568-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(pulse2 <span class="sc">~</span> exercise, <span class="at">data=</span>pulse)</span>
<span id="cb568-2"><a href="data-types-part-2.html#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ exercise, data = pulse)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -39.45 -24.45 -12.97  27.55  82.36 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        93.643      8.510  11.004   &lt;2e-16 ***
## exercisemoderate    3.805      9.481   0.401    0.689    
## exerciselow         3.330      9.991   0.333    0.740    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.84 on 106 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.001533,   Adjusted R-squared:  -0.01731 
## F-statistic: 0.08139 on 2 and 106 DF,  p-value: 0.9219</code></pre>
<p>In the results, <code>exercisemoderate</code> represents the effect of <code>exercise='moderate'</code> versus the reference category <code>exercise='high'</code>. By default, the first level of the factor is taken as the reference category, and this is often the first level in alphabetical order.</p>
<p>The model fit above yields tests per category of <code>exercise</code>, compared with the reference category. However, a test for the effect of the entire variable <code>exercise</code> is not directly available. This can be obtained with ANOVA (Analysis of Variance).</p>
</div>
<div id="the-anova-table-and-f-test" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> The ANOVA table and F-test</h4>
<p>The ANOVA table can be obtained by using the function <code>anova</code> and the model fit <code>fit</code>:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="data-types-part-2.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: pulse2
##            Df Sum Sq Mean Sq F value Pr(&gt;F)
## exercise    2    165   82.51  0.0814 0.9219
## Residuals 106 107461 1013.78</code></pre>
<p>We can also compare two model fits using ANOVA. Say that we want to check if the above model fit improves by including <code>gender</code> in the model. Then we fit a model with both <code>exercise</code> and <code>gender</code>, and compare this new fit with the above one:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="data-types-part-2.html#cb572-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pulse2 <span class="sc">~</span> exercise <span class="sc">+</span> gender, <span class="at">data=</span>pulse)</span>
<span id="cb572-2"><a href="data-types-part-2.html#cb572-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit, fit2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: pulse2 ~ exercise
## Model 2: pulse2 ~ exercise + gender
##   Res.Df    RSS Df Sum of Sq     F Pr(&gt;F)
## 1    106 107461                          
## 2    105 107117  1    343.83 0.337 0.5628</code></pre>
<p>Note that <code>lm</code> by default removes any subjects which have missing values in at least one of the covariates. This means that the number of subjects in <code>fit</code> and <code>fit0</code> may be different and error returned. In that case remove subjects with missing values manually (or do imputation or something more fancy).</p>
</div>
<div id="model-fit-without-a-reference-category" class="section level4" number="3.5.2.3">
<h4><span class="header-section-number">3.5.2.3</span> (*) Model fit without a reference category</h4>
<p>When fitting a regression model, we can do without a reference category in a model fit by suppressing the intercept:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="data-types-part-2.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(pulse2 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> gender, <span class="at">data=</span>pulse)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ 0 + gender, data = pulse)
## 
## Coefficients:
## genderfemale    gendermale  
##        98.92         95.00</code></pre>
<p>The coefficient now represents the mean in the group (male or female), instead of a comparison between males and females (such a comparison is called a contrast).</p>
<p>Note that the reference category is only suppressed for the first factor in the formula:</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="data-types-part-2.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(pulse2 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> gender <span class="sc">+</span> ran, <span class="at">data=</span>pulse)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ 0 + gender + ran, data = pulse)
## 
## Coefficients:
## genderfemale    gendermale        ransat  
##       127.99        125.80        -51.92</code></pre>
<p>Note that suppressing the intercept has a different effect for explanatory factors and for continuous explanatory variables.</p>
</div>
</div>
<div id="generalized-linear-models-and-survival" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> (*) Generalized linear models and survival</h3>
<p>Regression models can be run using the function <code>glm</code> (generalized linear model), which has very similar syntax to <code>lm</code>. Amongst useful models are logistic models.</p>
<div id="logistic-regression-and-anova" class="section level4" number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> (*) Logistic regression and ANOVA</h4>
<p>For logistic regression, use <code>glm</code> with slot <code>family=binomial</code>.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="data-types-part-2.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="do">## fit &lt;- glm(alcohol ~ gender + smokes + exercise, family=binomial, data=pulse)</span></span>
<span id="cb578-2"><a href="data-types-part-2.html#cb578-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse2 ~ exercise, data = pulse)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -39.45 -24.45 -12.97  27.55  82.36 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        93.643      8.510  11.004   &lt;2e-16 ***
## exercisemoderate    3.805      9.481   0.401    0.689    
## exerciselow         3.330      9.991   0.333    0.740    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.84 on 106 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.001533,   Adjusted R-squared:  -0.01731 
## F-statistic: 0.08139 on 2 and 106 DF,  p-value: 0.9219</code></pre>
<p>When using <code>anova</code> in <code>glm</code>, the default is not to give a p-value. If you want it, explicitly ask for one. In case of the logistic model, the adequate way to compute the ANOVA p-value is via the likelihood ratio test (LRT):</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="data-types-part-2.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit, <span class="at">test=</span><span class="st">&#39;LRT&#39;</span>)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: pulse2
##            Df Sum Sq Mean Sq F value Pr(&gt;F)
## exercise    2    165   82.51  0.0814 0.9219
## Residuals 106 107461 1013.78</code></pre>
</div>
<div id="survival-analysis" class="section level4" number="3.5.3.2">
<h4><span class="header-section-number">3.5.3.2</span> (*) Survival analysis</h4>
<p>Survival analysis methods are available in the <code>survival</code> package, which is installed automatically with the base package. The syntax is similar to <code>lm</code> and <code>glm</code>, except that the response has to be a <code>Surv</code> object, built from two separate variables giving time and event.</p>
<p>We do not have survival times in the <code>pulse</code> data, so we use the <code>aml</code> data from the <code>survival</code> package.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="data-types-part-2.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb582-2"><a href="data-types-part-2.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ?aml</span></span>
<span id="cb582-3"><a href="data-types-part-2.html#cb582-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(aml, <span class="fu">Surv</span>(time, status))</span></code></pre></div>
<pre><code>##  [1]   9   13   13+  18   23   28+  31   34   45+  48  161+   5    5    8    8 
## [16]  12   16+  23   27   30   33   43   45</code></pre>
<p>To draw Kaplan-Meier curves, use <code>survfit</code>:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="data-types-part-2.html#cb584-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> x, <span class="at">data=</span>aml)</span>
<span id="cb584-2"><a href="data-types-part-2.html#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
<p>A log-rank test can be computed using:</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="data-types-part-2.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> x, <span class="at">data=</span>aml)</span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time, status) ~ x, data = aml)
## 
##                  N Observed Expected (O-E)^2/E (O-E)^2/V
## x=Maintained    11        7    10.69      1.27       3.4
## x=Nonmaintained 12       11     7.31      1.86       3.4
## 
##  Chisq= 3.4  on 1 degrees of freedom, p= 0.07</code></pre>
<p>A Cox model can be fitted as follows:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="data-types-part-2.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> x, <span class="at">data=</span>aml)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ x, data = aml)
## 
##                  coef exp(coef) se(coef)     z      p
## xNonmaintained 0.9155    2.4981   0.5119 1.788 0.0737
## 
## Likelihood ratio test=3.38  on 1 df, p=0.06581
## n= 23, number of events= 18</code></pre>
<p>As before, each object can be stored separately. In particular, the Surv object can be saved and the entire analysis run using it.</p>
<p>The result of coxph can be stored as an object and manipulated in most ways like a <code>lm</code> or <code>glm</code> object. In particular we can use <code>anova</code> to compare different model fits.</p>
<hr />
<blockquote>
<p><em>Quick task(s)</em>:</p>
<p>Solve <a href="04_advanced_factors.tasks.nocode.html#anova">the task(s)</a>, and check your solution(s) <a href="04_advanced_factors.tasks.code.html#anova">here</a>.</p>
</blockquote>
<hr />

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-types-part-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
